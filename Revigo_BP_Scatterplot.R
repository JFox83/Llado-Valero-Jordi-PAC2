# A plotting R script produced by the Revigo server at http://revigo.irb.hr/
# If you found Revigo useful in your work, please cite the following reference:
# Supek F et al. "REVIGO summarizes and visualizes long lists of Gene Ontology
# terms" PLoS ONE 2011. doi:10.1371/journal.pone.0021800

# --------------------------------------------------------------------------
# If you don't have the ggplot2 package installed, uncomment the following line:
# install.packages( "ggplot2" );
library( ggplot2 );

# --------------------------------------------------------------------------
# If you don't have the scales package installed, uncomment the following line:
# install.packages( "scales" );
library( scales );

# --------------------------------------------------------------------------
# Here is your data from Revigo. Scroll down for plot configuration options.

revigo.names <- c("term_ID","description","frequency","plot_X","plot_Y","log_size","value","uniqueness","dispensability");
revigo.data <- rbind(c("GO:0006109","regulation of carbohydrate metabolic process",0.9953030641914561,3.7838782043216597,-1.773335672020986,2.2528530309798933,-1.3714622054997974,0.9540794443694777,0.12209881),
c("GO:0006403","RNA localization",1.0288526056810556,-6.980361306190196,2.6021258193245678,2.2671717284030137,-1.357435827381193,0.9204785199223385,0.18884812),
c("GO:0006820","monoatomic anion transport",0.9841198836949228,-5.780435397306459,4.0082379033574975,2.247973266361807,-1.396121526190944,0.8997663011760784,0.56539235),
c("GO:0006821","chloride transport",0.7604562737642585,-6.122344403417606,4.142657647966585,2.1367205671564067,-1.4134259543597827,0.9019521698817835,0.26647383),
c("GO:0006909","phagocytosis",0.9002460299709237,-4.824886595592364,3.1999860564988265,2.2095150145426308,-1.3362201555986477,0.9174976470369884,0.27132983),
c("GO:0007200","phospholipase C-activating G protein-coupled receptor signaling pathway",0.8051889957503914,6.090164704966995,3.707088101893785,2.161368002234975,-1.420793688392829,0.9341102436848413,0.1699269),
c("GO:0014074","response to purine-containing compound",0.810780585998658,1.8561873590237412,6.146506047925853,2.164352855784437,-1.411427745949038,0.9315911118183343,0.25880236),
c("GO:0014812","muscle cell migration",0.156564526951465,-1.145751307671265,-1.415625568513272,1.462397997898956,-1.4232668823857921,0.9874458818286656,0.00515006),
c("GO:0014909","smooth muscle cell migration",0.0782822634757325,-0.719348335581078,-1.7236397974564526,1.1760912590556813,-1.424469624291472,0.9875864651087064,0.41443294),
c("GO:0014910","regulation of smooth muscle cell migration",0.3690449563855961,0.7347705775271869,-5.828406966274842,1.8260748027008264,-1.424469624291472,0.9604149614913823,0.0289787),
c("GO:0014911","positive regulation of smooth muscle cell migration",0.21807201968239764,1.2973584635891768,-5.499634213007985,1.6020599913279623,-1.481170905473963,0.9185253989129695,0.47446616),
c("GO:0015698","inorganic anion transport",1.056810556922389,-5.1573508720202605,2.565278665056614,2.278753600952829,-1.396121526190944,0.918867845549073,0.23167772),
c("GO:0015931","nucleobase-containing compound transport",1.2804741668530528,-5.915000003447684,2.998342089705322,2.361727836017593,-1.340660988647895,0.9027079765714797,0.28206129),
c("GO:0016051","carbohydrate biosynthetic process",0.6821740102885261,-3.912690836996643,8.236471424056512,2.089905111439398,-1.3486927800842896,0.9733778084088952,0.09037915),
c("GO:0019751","polyol metabolic process",0.525609483337061,1.5430254207164609,0.807992877717671,1.9777236052888478,-1.4232668823857921,0.9025832732916945,-0),
c("GO:0032409","regulation of transporter activity",1.0344441959293222,-2.8881971931281707,-5.301830475305961,2.2695129442179165,-1.3077931845412627,0.8712292259248728,0.38758354),
c("GO:0033002","muscle cell proliferation",0.2460299709237307,-6.928052845353548,-2.7046727115869236,1.6532125137753437,-1.3306420848110063,0.9763985820715662,0.00571537),
c("GO:0034331","cell junction maintenance",0.27398792216506374,-1.5369767045590605,8.826795060932843,1.6989700043360187,-1.481170905473963,0.972823203487986,0.13261413),
c("GO:0034694","response to prostaglandin",0.20688883918586445,1.4095918886935055,7.1711608004993135,1.5797835966168101,-1.481170905473963,0.9260115482730326,0.06848597),
c("GO:0035589","G protein-coupled purinergic nucleotide receptor signaling pathway",0.07269067322746589,6.582993968019101,2.363546841540446,1.146128035678238,-1.481170905473963,0.942443629642896,0.27736347),
c("GO:0035590","purinergic nucleotide receptor signaling pathway",0.1621561171997316,6.013803849285855,2.4857381836276997,1.4771212547196624,-1.481170905473963,0.9390576580499282,-0),
c("GO:0043647","inositol phosphate metabolic process",0.1621561171997316,1.8719253299887706,0.7084970484264453,1.4771212547196624,-1.481170905473963,0.8952054764044598,0.68333625),
c("GO:0043954","cellular component maintenance",0.3690449563855961,-2.259643061128995,8.045391263750245,1.8260748027008264,-1.424469624291472,0.9910815245502925,0.00551725),
c("GO:0045913","positive regulation of carbohydrate metabolic process",0.45291881010959517,3.3496997981863657,-3.640006691249589,1.9138138523837167,-1.424469624291472,0.8730445725175552,0.16322723),
c("GO:0046683","response to organophosphorus",0.7269067322746589,2.2472774403802687,7.296242890349446,2.1172712956557644,-1.4134259543597827,0.9384711552058026,0.22697161),
c("GO:0048659","smooth muscle cell proliferation",0.04473272198613285,-6.688130379798006,-2.9021428185671962,0.9542425094393249,-1.396121526190944,0.9690770995269705,0.44616371),
c("GO:0048660","regulation of smooth muscle cell proliferation",0.7660478640125251,6.5053469895769505,-0.5554191318802592,2.1398790864012365,-1.396121526190944,0.942827535745172,0.03549273),
c("GO:0051028","mRNA transport",0.7157235517781256,-6.469820280824228,3.0820103994640875,2.110589710299249,-1.4134259543597827,0.867793989519637,0.48284199),
c("GO:0051208","sequestering of calcium ion",0.02795795124133304,-6.619266299790581,0.7105356520291777,0.7781512503836436,-1.411427745949038,0.9342064329079715,0.68758238),
c("GO:0051282","regulation of sequestering of calcium ion",0.710131961529859,-4.940387727058539,-4.137493154615819,2.1072099696478683,-1.411427745949038,0.8116312965068819,0.03303562),
c("GO:0051651","maintenance of location in cell",0.5535674345783941,-6.311424263569012,1.4041099188900639,2,-1.3362201555986477,0.9198894627071325,0.21007652),
c("GO:0060191","regulation of lipase activity",0.1789308879445314,-2.445543424148658,-5.11745887806446,1.5185139398778875,-1.424469624291472,0.8762398874649114,0.01863171),
c("GO:0060193","positive regulation of lipase activity",0.11742339521359875,-2.3880187978267715,-5.459753175235422,1.3424226808222062,-1.4604159477562633,0.8519312487220292,0.50498065),
c("GO:0070374","positive regulation of ERK1 and ERK2 cascade",1.067993737418922,2.7982654218656133,-5.123818311470621,2.2833012287035497,-1.3486927800842896,0.9181505805710864,0.03703178),
c("GO:0070633","transepithelial transport",0.18452247819279805,-4.601724828477997,4.3729605595899095,1.5314789170422551,-1.481170905473963,0.9303711786571159,0),
c("GO:0071415","cellular response to purine-containing compound",0.07269067322746589,2.285747815906614,5.509957804464296,1.146128035678238,-1.481170905473963,0.927760642436825,0.48344),
c("GO:0097305","response to alcohol",1.509729367031984,2.83816562133867,6.6016095558128,2.432969290874406,-1.330572247913444,0.9111604827513922,0.52469704),
c("GO:0097306","cellular response to alcohol",0.5703422053231939,3.4981872413362156,6.0105604599704465,2.012837224705172,-1.424469624291472,0.891280826061067,0.52377377),
c("GO:0097553","calcium ion transmembrane import into cytosol",0.5088347125922612,-5.848583329779867,4.444020948492426,1.9637878273455553,-1.3486927800842896,0.8960845743210694,0.52868431),
c("GO:1901019","regulation of calcium ion transmembrane transporter activity",0.34667859539252965,-3.5274709517135467,-4.8256936820340455,1.7993405494535817,-1.424469624291472,0.6373620049880482,0.41262764),
c("GO:1901654","response to ketone",1.2357414448669202,3.1245973361279042,6.655362896128034,2.346352974450639,-1.3486927800842896,0.9126291674759693,0.27371564),
c("GO:1901655","cellular response to ketone",0.5871169760679937,3.327751820837639,5.806611794834095,2.0253058652647704,-1.424469624291472,0.8894448287465735,0.47270399),
c("GO:1902930","regulation of alcohol biosynthetic process",0.28517110266159695,5.275469538680821,-3.1119905425660903,1.7160033436347992,-1.4659046268995228,0.9105619292679932,0.02252502),
c("GO:1902932","positive regulation of alcohol biosynthetic process",0.1509729367031984,4.6629034922705195,-3.584149572841836,1.4471580313422192,-1.481170905473963,0.867678476033008,0.63800926),
c("GO:1904705","regulation of vascular associated smooth muscle cell proliferation",0.3299038246477298,6.4408500945434435,-0.22660011704227126,1.7781512503836436,-1.424469624291472,0.924816250787424,0.40652559));

one.data <- data.frame(revigo.data);
names(one.data) <- revigo.names;
one.data <- one.data [(one.data$plot_X != "null" & one.data$plot_Y != "null"), ];
one.data$plot_X <- as.numeric( as.character(one.data$plot_X) );
one.data$plot_Y <- as.numeric( as.character(one.data$plot_Y) );
one.data$log_size <- as.numeric( as.character(one.data$log_size) );
one.data$value <- as.numeric( as.character(one.data$value) );
one.data$frequency <- as.numeric( as.character(one.data$frequency) );
one.data$uniqueness <- as.numeric( as.character(one.data$uniqueness) );
one.data$dispensability <- as.numeric( as.character(one.data$dispensability) );
#head(one.data);


# --------------------------------------------------------------------------
# Names of the axes, sizes of the numbers and letters, names of the columns,
# etc. can be changed below

p1 <- ggplot( data = one.data );
p1 <- p1 + geom_point( aes( plot_X, plot_Y, colour = value, size = log_size), alpha = I(0.6) );
p1 <- p1 + scale_colour_gradientn( colours = c("blue", "green", "yellow", "red"), limits = c( min(one.data$value), 0) );
p1 <- p1 + geom_point( aes(plot_X, plot_Y, size = log_size), shape = 21, fill = "transparent", colour = I (alpha ("black", 0.6) ));
p1 <- p1 + scale_size( range=c(5, 30)) + theme_bw(); # + scale_fill_gradientn(colours = heat_hcl(7), limits = c(-300, 0) );
ex <- one.data [ one.data$dispensability < 0.15, ];
p1 <- p1 + geom_text( data = ex, aes(plot_X, plot_Y, label = description), colour = I(alpha("black", 0.85)), size = 3 );
p1 <- p1 + labs (y = "semantic space x", x = "semantic space y");
p1 <- p1 + theme(legend.key = element_blank()) ;
one.x_range = max(one.data$plot_X) - min(one.data$plot_X);
one.y_range = max(one.data$plot_Y) - min(one.data$plot_Y);
p1 <- p1 + xlim(min(one.data$plot_X)-one.x_range/10,max(one.data$plot_X)+one.x_range/10);
p1 <- p1 + ylim(min(one.data$plot_Y)-one.y_range/10,max(one.data$plot_Y)+one.y_range/10);


# --------------------------------------------------------------------------
# Output the plot to screen

p1;

# Uncomment the line below to also save the plot to a file.
# The file type depends on the extension (default=pdf).

# ggsave("/path_to_your_file/revigo-plot.pdf");

